{{> header}}


<div class="container">
  <div class="row">
    <div class="col-md-9">

      <div id="crd_img" class="row">
        <!--Carousel Wrapper-->
                <div id="carousel-example-1z" class="carousel slide carousel-fade" data-ride="carousel">
                    <!--Indicators-->
                    <ol class="carousel-indicators">
                        <li data-target="#carousel-example-1z" data-slide-to="0" class="active"></li>
                        <li data-target="#carousel-example-1z" data-slide-to="1"></li>
                        <li data-target="#carousel-example-1z" data-slide-to="2"></li>
                    </ol>
                    <!--/.Indicators-->
                    <!--Slides-->
                    <div class="carousel-inner" role="listbox">
                        <!--First slide-->
                        <div class="carousel-item active">
                            <img class="d-block w-100" style="height:400px;" src="../../public/images/dest_sri.jpg" alt="First slide">
                        </div>
                        <!--/First slide-->
                        {{#each images}}
                        <!--Second slide-->
                        <div class="carousel-item">
                            <img class="d-block w-100" style="height:400px;" src="../../{{this.img_url}}" alt="Second slide">
                        </div>
                        <!--/Second slide-->
                        {{/each}}
                    </div>
                    <!--/.Slides-->
                    <!--Controls-->
                    <a class="carousel-control-prev" href="#carousel-example-1z" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carousel-example-1z" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                    <!--/.Controls-->
                </div>
                <!--/.Carousel Wrapper-->
      </div>

      <div id="crd_body" class="row">
                  <!--Panel-->
          <div  class="card w-100">
              <div class="card-body transparent">

                  <h3 class="card-title">{{this.b_name1}} {{this.m_name1}}</h3>
                  {{#each v_details}}
                  <h3>Owner</h3>
                  <h5 class="primary-text">{{this.owner}}</h5>
                  <hr>
                  <h3>Description</h3>
                  <p class="card-text primary-text">{{this.description}}</p>
                  <hr>
                  <strong class="p-3 mb-2 bg-success text-white">RS {{this.rate}} per 1 KM</strong>

                  <hr>
                  <!-- Button trigger modal -->
                  <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal123">
                    Launch demo modal
                  </button>


                  {{/each}}
              </div>
          </div>
          <!--/.Panel-->
      </div>
    </div>


    <div class="col-md-3">
      <p class="font-weight-normal">Related Vehicles.</p>
      <div class="list-group">
        {{#each models}}
        <a href="/vehicle/display_relativevcls?m_id={{this.id}}&b_id={{this.brand_id}}" class="list-group-item waves-effect">{{this.m_name}}</a>
        {{/each}}

      </div>
    </div>
  </div>

  <div class="row">
    <div class="container text-center my-3">
        <h3>Related vehicles</h3>
        <div id="recipeCarousel" class="carousel slide w-100" data-ride="carousel">
            <div class="carousel-inner w-100" role="listbox">
                <div class="carousel-item row active">
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(7).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(9).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(17).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(27).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                </div>
                <div class="carousel-item row">
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(13).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(12).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(7).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                    <div class="col-3 float-left">
                      <div class="view zoom">
                        <img src="https://mdbootstrap.com/img/Photos/Horizontal/People/6-col/img%20(7).jpg" class="img-fluid " alt="">
                        <div class="mask flex-center">
                            <p class="white-text">Zoom effect</p>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
            <a class="carousel-control-prev" href="#recipeCarousel" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#recipeCarousel" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>


    </div>
  </div>




</div>



<!-- Modal -->
<div class="modal fade" id="exampleModal123" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body">
            <div id='top'>

              <div style='float:left'>
                Timezone:
                <select id='timezone-selector'>
                  <option value='' selected>none</option>
                  <option value='local'>local</option>
                  <option value='UTC'>UTC</option>
                </select>
              </div>

              <div style='float:right'>
                <span id='loading'>loading...</span>

              </div>

              <div style='clear:both'></div>
            </div>
              <div id="calendar"></div>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <a href="/vehicle/finalize_book?id={{id}}" id="save_btn" class="btn btn-primary">Save changes</a>
          </div>
      </div>
  </div>
</div>

<!--end of modal calander-->


<div class="container-fluid">
  {{> footer}}

</div>

<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
 <script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.4.0/fullcalendar.min.js"></script>

 <script type="text/javascript" src="/javascripts/jquery.smartWizard.min.js"></script>
<script type="text/javascript">
  $(document).ready(function(){
    (function($) {
    "use strict";

    // manual carousel controls
    $('.next').click(function(){ $('.carousel').carousel('next');return false; });
    $('.prev').click(function(){ $('.carousel').carousel('prev');return false; });

})(jQuery);
  });
</script>
<script type="text/javascript">
$(document).ready(function() {
  $('#myCarousel').carousel({
    interval: 10000
})
});
</script>
<script>

$(document).ready(function() {
 var calendar = $('#calendar').fullCalendar({
  editable:true,
  header:{
   left:'prev,next today',
   center:'title',
   right:'month,agendaWeek,agendaDay'
  },
  navLinks: true,
  loading: function(bool) {
      $('#loading').toggle(bool);
  },
  eventRender: function(event, el) {
  // render the timezone offset below the event title
  if (event.start.hasZone()) {
    el.find('.fc-title').after(
      $('<div class="tzo"/>').text(event.start.format('Z'))
    );
  }
},
  events:'/vehicle/book?vehi_id={{id}}',

  selectable:true,
  selectHelper:true,
  select: function(start, end, allDay)
  {
   var title = prompt("Enter Event Title");
   if(title)
   {
    var start = $.fullCalendar.formatDate(start, "Y-MM-DD HH:mm:ss");
    var end = $.fullCalendar.formatDate(end, "Y-MM-DD HH:mm:ss");
    var vehi_id={{id}};
      $.ajax({
        url:'/vehicle/insert_booking',
        type:'POST',
        data:{title:title,start:start,end:end,vehi_id:vehi_id},
        success:function(data){
          calendar.fullCalendar('refetchEvents');
          alert("added successfully");
        }
      });
   }
  },
  editable:true,
  eventResize:function(event)
  {
   var start = $.fullCalendar.formatDate(event.start, "Y-MM-DD HH:mm:ss");
   var end = $.fullCalendar.formatDate(event.end, "Y-MM-DD HH:mm:ss");
   var title = event.title;
   var id = event.id;
    $.ajax({
      url:'/vehicle/update_booking',
      type:'POST',
      data:{title:title,start:start,end:end,id:id},
      success:function(data){
        // calendar.fullCalendar('refetchEvents');
        alert("Update successfully");
      }
    })
  },

  eventDrop:function(event)
  {
   var start = $.fullCalendar.formatDate(event.start, "Y-MM-DD HH:mm:ss");
   var end = $.fullCalendar.formatDate(event.end, "Y-MM-DD HH:mm:ss");
   var title = event.title;
   var id = event.id;
   $.ajax({
     url:"/vehicle/update_booking",
     type:"POST",
     data:{title:title, start:start, end:end, id:id},
     success:function(data)
     {
      // calendar.fullCalendar('refetchEvents');
      alert("Event Updated");
     }
    });
  },

  eventClick:function(event)
  {
   if(confirm("Are you sure you want to remove it?"))
   {
    var id = event.id;
   	$.ajax({
       url:"/vehicle/delete_booking",
       type:"POST",
       data:{id:id},
       success:function(data)
       {
         calendar.fullCalendar('refetchEvents');
         alert("Event Removed");
       }
   	});
   }
  },

 });

 // load the list of available timezones, build the <select> options
 $.getJSON('https://fullcalendar.io/demo-timezones.json', function(timezones) {
   $.each(timezones, function(i, timezone) {
     if (timezone != 'UTC') { // UTC is already in the list
       $('#timezone-selector').append(
         $("<option/>").text(timezone).attr('value', timezone)
       );
     }
   });
 });

 // when the timezone selector changes, dynamically change the calendar option
 $('#timezone-selector').on('change', function() {
   $('#calendar').fullCalendar('option', 'timezone', this.value || false);
 });
});



</script>
